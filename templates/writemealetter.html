{% extends "base.html" %}
{% import "shortcodes/_macros.html" as macros %}
{% block title %}CHEMI FIQREBI ONLINE{% endblock title %}

{% block content %}
{{ macros::navbar() }}
<!-- {{ macros::vignette() }} -->

<link preconnect="true" rel="stylesheet" href="{{ get_url(path='writeme.css', cachebust=true) }}" />
<form id="writeme">
    <div class="writeme-container">
        <label for="author">author</label>
        <input placeholder="avtori" name="author" id="author" required minlength="1" />
        <label for="body">content</label>
        <textarea class="gadamishale" name="body" id="body" placeholder="momwere" required minlength="1" /></textarea>
        <input type="submit" class="submit" value="Send">
    </div>
</form>
<script>
    const form = document.querySelector("#writeme");

    form.addEventListener("submit", (e) => {
        e.preventDefault();

        const formData = new FormData(form);
        const payload = {
            author: formData.get("author"),
            body: formData.get("body")
        };

        const xhr = new XMLHttpRequest();
        xhr.open("POST", "https://t3pyuzjybj.execute-api.eu-north-1.amazonaws.com/default/chemifiqrebionline");
        xhr.setRequestHeader("Content-Type", "application/json");

        xhr.onload = () => {
            if (xhr.status >= 200 && xhr.status < 300) {
                alert("Success");
            } else {
                alert("Error: " + xhr.status);
            }
        };

        xhr.send(JSON.stringify(payload));
    });
</script>
{% endblock content %}